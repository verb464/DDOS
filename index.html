// Function to update info with real data
async function updateInfo() {
  // Fetch IP & geo info
  let ipData = await fetch('https://ipapi.co/json/').then(res => res.json()).catch(() => ({}));
  
  // Battery info
  let battery = null;
  if (navigator.getBattery) {
    battery = await navigator.getBattery();
  }

  // Local time
  let localTime = new Date().toLocaleTimeString();

  // Browser and OS
  const browser = navigator.userAgent;
  const os = navigator.platform;

  // Battery percent
  let batteryLevel = battery ? Math.round(battery.level * 100) + '%' : 'Unknown';

  // Location fallback text
  const city = ipData.city || 'Unknown City';
  const country = ipData.country_name || 'Unknown Country';

  // Show info
  const infoEl = document.getElementById('info');
  infoEl.innerHTML = `
    IP: ${ipData.ip || 'Unknown IP'}<br>
    Location: ${city}, ${country}<br>
    Battery: ${batteryLevel}<br>
    Local Time: ${localTime}<br>
    Device: ${os}<br>
    Browser: ${browser}<br>
  `;

  // Hacking status messages cycling
  const statusMessages = [
    "Rootkit Installed",
    "Firewall Disabled",
    "System Integrity Compromised",
    "Memory Leak Detected",
    "Remote Access Enabled",
    "Disk Sector Failure",
    "CPU Overheating",
  ];

  let index = 0;
  setInterval(() => {
    infoEl.innerHTML += `<br><span style="color:orange;">Status: ${statusMessages[index]}</span>`;
    index = (index + 1) % statusMessages.length;
  }, 4000);
}

// Call it once and then every 10 seconds update local time & battery
updateInfo();
setInterval(() => {
  // Just update local time & battery level without refetching IP/Geo
  const infoEl = document.getElementById('info');
  const localTime = new Date().toLocaleTimeString();

  navigator.getBattery && navigator.getBattery().then(battery => {
    const batteryLevel = battery ? Math.round(battery.level * 100) + '%' : 'Unknown';
    // Update only local time and battery by replacing lines inside the info
    infoEl.innerHTML = infoEl.innerHTML.replace(/Local Time: .*?<br>/, `Local Time: ${localTime}<br>`);
    infoEl.innerHTML = infoEl.innerHTML.replace(/Battery: .*?<br>/, `Battery: ${batteryLevel}<br>`);
  });
}, 10000);
